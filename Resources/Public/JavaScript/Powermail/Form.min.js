!function(){"use strict";function t(){var t="btn-primary";this.initialize=function(){n(),e()};var e=function(){for(var t=document.querySelectorAll("form.powermail_morestep"),e=0;e<t.length;e++)r(t[e])},r=function(t){a(0,t)},n=function(){for(var t=document.querySelectorAll("[data-powermail-morestep-show]"),e=0;e<t.length;e++)t[e].addEventListener("click",(function(t){var e=t.target.getAttribute("data-powermail-morestep-show"),r=t.target.closest("form");a(e,r)}))},a=function(t,e){i(e);var r=u(e);d(r[t]),o(e)},i=function(t){for(var e=u(t),r=0;r<e.length;r++)c(e[r])},o=function(e){for(var r=e.querySelectorAll("[data-powermail-morestep-current]"),n=l(e),a=0;a<r.length;a++)r[a].classList.remove(t),a===n&&r[a].classList.add(t)},l=function(t){for(var e=u(t),r=0;r<e.length;r++)if("none"!==e[r].style.display)return r},u=function(t){return t.querySelectorAll(".powermail_fieldset")},c=function(t){t.style.display="none"},d=function(t){t.style.display="block"}}function e(){var t="[data-powermail-validate]",e="parsley-error",r="data-powermail-class-handler";this.validate=function(){n(),a()};var n=function(){for(var e=document.querySelectorAll(t),r=function(t){var r=e[t];r.setAttribute("novalidate","novalidate"),r.addEventListener("submit",(function(r){r.preventDefault(),!1===i(e[t])&&alert("todo submit")}))},n=0;n<e.length;n++)r(n)},a=function(){for(var e=document.querySelectorAll(t),r=function(t){for(var r=h(e[t]),n=function(t){r[t].addEventListener("blur",(function(){o(r[t])})),r[t].addEventListener("change",(function(){o(r[t])}))},a=0;a<r.length;a++)n(a)},n=0;n<e.length;n++)r(n)},i=function(t){for(var e=!1,r=h(t),n=0;n<r.length;n++){var a=o(r[n]);!0===a&&(e=a)}return e},o=function(t){t=y(t);var e=!1;return!1===e&&(l(t)&&!1===c(t)?(s("required",t),e=!0):f("required",t)),!1===e&&(u(t)&&!1===d(t)?(s("pattern",t),e=!0):f("pattern",t)),e},l=function(t){return t.hasAttribute("required")||"true"===t.getAttribute("data-powermail-required")},u=function(t){return t.hasAttribute("pattern")||t.hasAttribute("data-powermail-pattern")},c=function(t){return""!==b(t)},d=function(t){var e=t.getAttribute("data-powermail-pattern")||t.getAttribute("pattern");return new RegExp(e,"").test(b(t))},s=function(t,e){f(t,e),m(e);var r=e.getAttribute("data-powermail-"+t+"-message")||e.getAttribute("data-powermail-error-message")||"Validation error";v(r,e)},f=function(t,e){p(e),g(e)},m=function(t){if(t.getAttribute(r))for(var n=document.querySelectorAll(t.getAttribute(r)),a=0;a<n.length;a++)n[a].classList.add(e);else t.classList.add(e)},p=function(t){if(t.getAttribute(r))for(var n=document.querySelectorAll(t.getAttribute(r)),a=0;a<n.length;a++)n[a].classList.remove(e);else t.classList.remove(e)},v=function(t,e){var r=document.createElement("ul");r.classList.add("parsley-errors-list"),r.classList.add("filled"),r.setAttribute("data-powermail-error",A(e));var n=document.createElement("li");n.classList.add("parsley-required"),r.appendChild(n);var a=document.createTextNode(t);if(n.appendChild(a),null!==e.getAttribute("data-powermail-errors-container")){var i=document.querySelector(e.getAttribute("data-powermail-errors-container"));null!==i&&i.appendChild(r)}else e.parentNode.appendChild(r)},g=function(t){var e=document.querySelector('[data-powermail-error="'+A(t)+'"]');null!==e&&e.remove()},b=function(t){var e=t.value;if("radio"===t.getAttribute("type")||"checkbox"===t.getAttribute("type")){e="";var r=t.getAttribute("name"),n=t.closest("form").querySelector('input[name="'+r+'"]:checked');null!==n&&(e=n.value)}return e},A=function(t){return t.getAttribute("name").replace(/[^\w\s]/gi,"")},h=function(t){return t.querySelectorAll('input:not([data-powermail-validation="disabled"]):not([type="hidden"]):not([type="submit"]), textarea:not([data-powermail-validation="disabled"]), select:not([data-powermail-validation="disabled"])')},y=function(t){if("radio"===t.getAttribute("type")||"checkbox"===t.getAttribute("type")){var e=t.getAttribute("name"),r=t.closest("form");t=r.querySelectorAll('[name="'+e+'"]')[0]}return t}}(new function(){this.initialize=function(){r(),n(),a()};var r=function(){(new e).validate()},n=function(){(new t).initialize()},a=function(){null!==document.querySelector('[data-powermail-location="prefill"]')&&navigator.geolocation.getCurrentPosition((function(t){var e=t.coords.latitude,r=t.coords.longitude,n=document.querySelector("[data-powermail-eidurl]").getAttribute("data-powermail-eidurl");fetch(n+"?eID=powermailEidGetLocation&lat="+e+"&lng="+r).then((function(t){return t.text()})).then((function(t){for(var e=document.querySelectorAll('[data-powermail-location="prefill"]'),r=0;r<e.length;r++)e[r].value=t})).catch((function(t){console.log(t)}))}))}}).initialize()}();
